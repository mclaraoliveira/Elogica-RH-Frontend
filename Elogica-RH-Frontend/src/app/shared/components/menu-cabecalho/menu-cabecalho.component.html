<header class="d-flex justify-content-between align-items-center px-3 py-2 pe-4" style="background-color: #1F3E6A; height: 62px;">
  <div class="d-flex flex-column align-items-center">
    <img src="../../../assets/Logo.png" alt="Logo Elógica" style="width: 120px; height: 42px;">
    <div class="text-white" style="font-size: 8px;">Empresa/Máquina/Versão</div>
  </div>

  <div class="d-flex align-items-center gap-3 position-relative text-white">
    <div class="text-center me-2" style="font-size: 18px; line-height: 1.2; cursor: pointer;">
      <i class="bi bi-lightbulb"></i>
      <span id="themeText" class="d-block" style="font-size: 10px;">Claro</span>
    </div>

    <div class="vr text-light"></div>

    <i class="bi bi-search fs-5" (click)="toggleSearch()" style="cursor: pointer;"></i>
    <i class="bi bi-question-lg fs-5"></i>
    <i class="bi bi-chat-left-text fs-5" (click)="toggleMessages()" style="cursor: pointer;"></i>

    <div class="position-relative" (click)="toggleNotifications()" style="cursor: pointer;">
      <i class="bi bi-bell fs-5 me-2 ps-2"></i>
      <span *ngIf="notifications.length > 0" class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">
        {{ notifications.length > 9 ? '9+' : notifications.length }}
      </span>
    </div>

    <div class="vr text-light"></div>

    <div class="d-flex align-items-center profile-area" style="cursor: pointer;" (click)="toggleProfile()">
      <img src="/assets/Avatar.png" alt="Avatar do Perfil" class="rounded-circle me-2" style="width: 32px; height: 32px;">
      <span class="me-2 text-white">Lucas Pereira</span>
      <i class="bi" [class.bi-chevron-down]="!isProfileVisible()" [class.bi-chevron-up]="isProfileVisible()" class="ms-1"></i>
    </div>

    <div *ngIf="isSearchVisible()" class="search-container position-absolute top-100 end-0 p-2 mt-1 rounded shadow d-flex flex-column bg-body">
      <input type="text" class="form-control text-dark bg-light" placeholder="Pesquisar...">
    </div>

    <div *ngIf="isProfileVisible()" class="position-absolute start-0 end-0 top-0 bg-light" style="z-index: 1050; padding: 1rem;">
      <div class="d-flex align-items-center mb-3">
        <img src="/assets/Avatar.png" alt="Avatar" class="rounded-circle me-2" style="width: 48px; height: 48px;">
        <div class="flex-grow-1">
          <div class="d-flex justify-content-between align-items-center">
            <div class="text-dark">Lucas Pereira</div>
            <i class="bi bi-chevron-up text-dark"></i>
          </div>
          <div>
            <small><strong class="text-secondary">Perfil:</strong> <span class="text-muted"> Analista</span></small>
          </div>
          <div>
            <small><strong class="text-secondary">Empresa:</strong> <span class="text-muted"> FCVS.SA</span></small>
          </div>
        </div>
      </div>

      <hr class="my-2">

      <div class="d-flex flex-column">
        <button class="btn btn-link text-start p-0 mb-2 text-decoration-none text-dark" type="button">
          <i class="bi bi-gear me-2"></i> Configurações
        </button>
        <button class="btn btn-link text-start p-0 mb-2 text-decoration-none text-dark" type="button">
          <i class="bi bi-universal-access me-2"></i> Acessibilidade
        </button>
        <button class="btn btn-link text-start p-0 text-decoration-none text-dark" type="button">
          <i class="bi bi-box-arrow-right me-2"></i> Sair
        </button>
      </div>
    </div>

    <div *ngIf="isMessagesVisible() || isNotificationsVisible()" class="search-container position-absolute top-100 end-0 p-2 mt-1 rounded shadow d-flex flex-column bg-body">
      <div class="messages-list-wrapper flex-grow-1" style="max-height: 260px; overflow-y: auto;">
        <div class="messages-list">
          <div *ngFor="let item of isMessagesVisible() ? messages : notifications; let i = index" class="d-flex align-items-center mt-2" [ngClass]="getRowClass(i)">
            <i *ngIf="isMessagesVisible()" class="bi bi-chat-left-text fs-5 me-2 ps-2 text-dark"></i>
            <i *ngIf="isNotificationsVisible()" [class]="item.icon + ' fs-5 me-2 ps-2 ' + item.color"></i>
            <div class="message-item p-2 flex-grow-1">
              <div class="text-primary text-decoration-underline">{{ item.text }}</div>
              <small class="text-muted">{{ item.date }}</small>
            </div>
          </div>
        </div>
      </div>

      <div class="text-center p-2 bg-light-blue text-dark">
        <a href="#" class="text-decoration-none">
          {{ isMessagesVisible() ? 'Ver todas as mensagens' : 'Ver todas as notificações' }}
        </a>
      </div>
    </div>

  </div>
</header>
